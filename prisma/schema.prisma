generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model Player {
  id           String     @id @default(uuid())
  name         String
  jerseyNumber Int?       // Added from PlayHQ
  photoUrl     String?    // Player profile image
  height       String?    // e.g. "6'2" or "188cm"
  weight       String?    // e.g. "190 lbs" or "86kg"
  positions    String?    // e.g. "PG, SG"
  active       Boolean    @default(true)
  createdAt    DateTime   @default(now())

  GameStats GameStat[]
  Fees      Fee[]
  Payments  Payment[]
}

model Game {
  id            String     @id @default(uuid())
  opponent      String
  date          DateTime
  teamScore     Int
  opponentScore Int
  result        String     // e.g., "W", "L", "D"
  season        String
  createdAt     DateTime   @default(now())

  GameStats     GameStat[]
}

model GameStat {
  id       String @id @default(uuid())
  gameId   String
  playerId String
  points   Int
  ones     Int    @default(0) // Free throws
  twos     Int    @default(0) // 2-point FGs
  threes   Int    @default(0) // 3-point FGs
  fouls    Int    @default(0) // Personal fouls

  Game     Game   @relation(fields: [gameId], references: [id], onDelete: Cascade)
  Player   Player @relation(fields: [playerId], references: [id], onDelete: Cascade)
}

model Fee {
  id          String   @id @default(uuid())
  playerId    String
  amount      Float
  season      String
  description String
  createdAt   DateTime @default(now())

  Player      Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)
}

model Payment {
  id        String   @id @default(uuid())
  playerId  String
  amount    Float
  date      DateTime @default(now())

  Player    Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)
}
